<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>4.8. Password Management</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><meta name="keywords" content="ltcluster, LightDB, replication, asynchronous, HA, high-availability" /><link rel="prev" href="configuration-permissions.html" title="4.7. ltcluster database user permissions" /><link rel="next" href="cloning-standbys.html" title="Chapter 5. Cloning standbys" /></head><body><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="5" align="center">4.8. Password Management</th></tr><tr><td width="10%" align="left"><a accesskey="p" href="configuration-permissions.html" title="4.7. ltcluster database user permissions">Prev</a> </td><td width="10%" align="left"><a accesskey="u" href="configuration.html" title="Chapter 4. ltcluster configuration">Up</a></td><th width="60%" align="center">Chapter 4. ltcluster configuration</th><td width="10%" align="right"><a accesskey="h" href="index.html" title="ltcluster 5.2.1 Documentation">Home</a></td><td width="10%" align="right"> <a accesskey="n" href="cloning-standbys.html" title="Chapter 5. Cloning standbys">Next</a></td></tr></table><hr></hr></div><div class="sect1" id="CONFIGURATION-PASSWORD-MANAGEMENT"><div class="titlepage"><div><div><h2 class="title" style="clear: both">4.8. Password Management</h2></div></div></div><div class="toc"><dl class="toc"><dt><span class="sect2"><a href="configuration-password-management.html#CONFIGURATION-PASSWORD-MANAGEMENT-OPTIONS">4.8.1. Password Management Options</a></span></dt><dt><span class="sect2"><a href="configuration-password-management.html#CONFIGURATION-PASSWORD-FILE">4.8.2. Using a password file</a></span></dt></dl></div><a id="id-1.4.2.9.2" class="indexterm"></a><div class="sect2" id="CONFIGURATION-PASSWORD-MANAGEMENT-OPTIONS"><div class="titlepage"><div><div><h3 class="title">4.8.1. Password Management Options</h3></div></div></div><a id="id-1.4.2.9.3.2" class="indexterm"></a><p>
    For security purposes it's desirable to protect database access using a password.
  </p><p>
    LightDB has three ways of providing a password:
    </p><div class="itemizedlist"><ul class="itemizedlist compact" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
           including the password in the <code class="option">conninfo</code> string
           (e.g. "<code class="literal">host=node1 dbname=ltcluster user=ltcluster password=foo</code>")
         </li><li class="listitem" style="list-style-type: disc">
           exporting the password as an environment variable (<code class="envar">PGPASSWORD</code>)
         </li><li class="listitem" style="list-style-type: disc">
           storing the password in a dedicated password file
         </li></ul></div><p>
  </p><p>
    We strongly advise against including the password in the <code class="option">conninfo</code> string, as
    this will result in the database password being exposed in various places, including in the
    <code class="filename">ltcluster.conf</code> file, the <code class="literal">ltcluster.nodes</code> table, any output
    generated by <span class="productname">ltcluster</span> which lists the node <code class="option">conninfo</code> strings (e.g.
    <a class="link" href="ltcluster-cluster-show.html" title="ltcluster cluster show">ltcluster cluster show</a>) and in the <span class="productname">ltcluster</span> log file,
    particularly at <code class="option">log_level=DEBUG</code>.
  </p><div class="note"><h3 class="title">Note</h3><p>
      Currently <span class="productname">ltcluster</span> does not fully support use of the <code class="option">password</code> option in the
      <code class="option">conninfo</code> string.
    </p></div><p>
    Exporting the password as an environment variable (<code class="envar">PGPASSWORD</code>) is considered
    less insecure, but the LightDB documentation explicitly recommends against doing this:
   </p><div class="blockquote"><table border="0" class="blockquote" style="width: 100%; cellspacing: 0; cellpadding: 0;" summary="Block quote"><tr><td width="10%" valign="top"> </td><td width="80%" valign="top"><p>
       <code class="envar">PGPASSWORD</code> behaves the same as the <code class="option">password</code>
       connection parameter. Use of this environment variable
       is not recommended for security reasons, as some operating systems
       allow non-root users to see process environment variables via
       <span class="application">ps</span>; instead consider using a password file.
     </p></td><td width="10%" valign="top"> </td></tr><tr><td width="10%" valign="top"> </td><td colspan="2" align="right" valign="top">--<span class="attribution"><a class="ulink" href="https://www.hs.net/lightdb/docs/current/libpq-envars.html" target="_top">Environment Variables</a></span></td></tr></table></div><p>

  </p><p>
    The most secure option for managing passwords is to use a dedicated password file; see the following
    section for more details.
  </p></div><div class="sect2" id="CONFIGURATION-PASSWORD-FILE"><div class="titlepage"><div><div><h3 class="title">4.8.2. Using a password file</h3></div></div></div><a id="id-1.4.2.9.4.2" class="indexterm"></a><a id="id-1.4.2.9.4.3" class="indexterm"></a><a id="id-1.4.2.9.4.4" class="indexterm"></a><p>
      The most secure way of storing passwords is in a password file,
      which by default is <code class="filename">~/.pgpass</code>. This file
      can only be read by the system user who owns the file, and
      LightDB will refuse to use the file unless read/write
      permissions are restricted to the file owner. The password(s)
      contained in the file will not be directly accessed by
      <span class="productname">ltcluster</span> (or any other libpq-based client software such as <span class="application">ltsql</span>).
    </p><p>
       For full details see the
       <a class="ulink" href="https://www.hs.net/lightdb/docs/current/libpq-pgpass.html" target="_top">LightDB password file documentation</a>.
    </p><p>
      For use with <span class="productname">ltcluster</span>, the <code class="filename">~/.pgpass</code> must two entries for each
      node in the replication cluster: one for the <span class="productname">ltcluster</span> user who accesses the <span class="productname">ltcluster</span> metadatabase,
      and one for replication connections (regardless of whether a dedicated replication user is used).
      The file must be present on each node in the replication cluster.
    </p><p>
      A <code class="filename">~/.pgpass</code> file for a 3-node cluster where the <code class="literal">ltcluster</code> database user
      is used for both for accessing the  <span class="productname">ltcluster</span> metadatabase and for replication connections would look like this:
      </p><pre class="programlisting">
node1:5432:ltcluster:ltcluster:foo
node1:5432:replication:ltcluster:foo
node2:5432:ltcluster:ltcluster:foo
node2:5432:replication:ltcluster:foo
node3:5432:ltcluster:ltcluster:foo
node3:5432:replication:ltcluster:foo</pre><p>
      If a dedicated replication user (here: <code class="literal">repluser</code>) is in use, the file would look like this:
      </p><pre class="programlisting">
node1:5432:ltcluster:ltcluster:foo
node1:5432:replication:repluser:foo
node2:5432:ltcluster:ltcluster:foo
node2:5432:replication:repluser:foo
node3:5432:ltcluster:ltcluster:foo
node3:5432:replication:repluser:foo</pre><p>
      If you are planning to use the <code class="option">-S</code>/<code class="option">--superuser</code> option,
      there must also be an entry enabling the superuser to connect to the <span class="productname">ltcluster</span> database.
      Assuming the superuser is <code class="literal">lightdb</code>, the file would look like this:
        </p><pre class="programlisting">
node1:5432:ltcluster:ltcluster:foo
node1:5432:ltcluster:lightdb:foo
node1:5432:replication:repluser:foo
node2:5432:ltcluster:ltcluster:foo
node2:5432:ltcluster:lightdb:foo
node2:5432:replication:repluser:foo
node3:5432:ltcluster:ltcluster:foo
node3:5432:ltcluster:lightdb:foo
node3:5432:replication:repluser:foo</pre><p>
    </p><p>
      The <code class="filename">~/.pgpass</code> file can be simplified with the use of wildcards if
      there is no requirement to restrict provision of passwords to particular hosts, ports
      or databases. The preceding file could then be formatted like this:
        </p><pre class="programlisting">
*:*:*:ltcluster:foo
*:*:*:lightdb:foo
</pre><p>
    </p><div class="note"><h3 class="title">Note</h3><p>
        It's possible to specify an alternative location for the <code class="filename">~/.pgpass</code> file, either via
        the environment variable <code class="envar">PGPASSFILE</code>, or (from LightDB 9.6) using the
        <code class="varname">passfile</code> parameter in connection strings.
      </p><p>
        If using the <code class="varname">passfile</code> parameter, it's essential to ensure the file is in the same
        location on all nodes, as when connecting to a remote node, the file referenced is the one on the
        local node.
      </p><p>
        Additionally, you <span class="emphasis"><em>must</em></span> specify the passfile location in <code class="filename">ltcluster.conf</code>
        with the <code class="option">passfile</code> option so <span class="productname">ltcluster</span> can write the correct path when creating the
        <code class="option">primary_conninfo</code> parameter for replication configuration on standbys.
      </p></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="configuration-permissions.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="configuration.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="cloning-standbys.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">4.7. ltcluster database user permissions </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Chapter 5. Cloning standbys</td></tr></table></div></body></html>